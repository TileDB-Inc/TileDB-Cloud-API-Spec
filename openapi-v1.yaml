swagger: "2.0"
info:
  description: TileDB Storage Platform REST API
  title: TileDB Storage Platform API
  version: 2.1.1

produces:
- application/json
consumes:
- application/json

schemes:
- http
- https

basePath: /v1

securityDefinitions:
  BasicAuth:
    type: basic
  ApiKeyAuth:
    type: apiKey
    in: header
    name: X-TILEDB-REST-API-KEY
  OAuth2:
      type: oauth2
      flow: accessCode
      authorizationUrl: https://oauth2.tiledb.com/oauth2/authorize
      tokenUrl: https://oauth2.tiledb.com/oauth2/token
      scopes:
        read: Grants read access
        write: Grants write access
        admin: Grants read and write access to administrative information

security:
  - BasicAuth: []
  - ApiKeyAuth: []
  # Commented out beacause this breaks the python autogenerated client
  # It always sets the Bearer authorization header even when empty :/
  # - OAuth2: [read, write, admin]

definitions:
  ArrayType:
    description: TileDB array type
    type: string
    enum: &ARRAYTYPE
      # Dense array
      - dense
      # Sparse array
      - sparse

  Datatype:
    description: TileDB data type
    type: string
    enum: &DATATYPE
      # 32-bit signed integer
      - INT32
      # 64-bit signed integer
      - INT64
      # 32-bit floating point value
      - FLOAT32
      # 64-bit floating point value
      - FLOAT64
      # Character
      - CHAR
      # 8-bit signed integer
      - INT8
      # 8-bit unsigned integer
      - UINT8
      # 16-bit signed integer
      - INT16
      # 16-bit unsigned integer
      - UINT16
      # 32-bit unsigned integer
      - UINT32
      # 64-bit unsigned integer
      - UINT64
      # ASCII string
      - STRING_ASCII
      # UTF-8 string
      - STRING_UTF8
      # UTF-16 string
      - STRING_UTF16
      # UTF-32 string
      - STRING_UTF32
      # UCS2 string
      - STRING_UCS2
      # UCS4 string
      - STRING_UCS4
      # This can be any datatype. Must store (type tag, value) pairs.
      - ANY

  ActivityEventType:
    description: Type of activity logged
    type: string
    enum: &ACTIVITYEVENTTYPE
      # read_schema operation
      - read_schema
      # max_buffer_sizes operation
      - max_buffer_sizes
      # non_empty_domain operation
      - non_empty_domain
      # query read operation
      - query_read
      # query write operation
      - query_write
      # create operation
      - create
      # delete operation
      - delete
      # register operation
      - register
      # deregister operation
      - deregister
      # udf operations
      - udf
      # get array metadata operation
      - array_metadata_get
      # update array metadata operation
      - array_metadata_update
      # estimated_result_sizes
      - estimated_result_sizes

  UDFLanguage:
    description: UDF Type
    type: string
    enum: &UDFLANGUAGE
      # python
      - python

  UDFType:
    description: UDF Type
    type: string
    enum: &UDFTYPE
      # single_array
      - single_array
      # generic
      - generic

  UDFResultType:
    description: Results type
    type: string
    enum: &UDFRESULTTYPE
      # native (i.e. cloud pickle)
      - native
      # JSON
      - json

  Layout:
    description: Layout of array
    type: string
    enum: &LAYOUT
      # Row-major layout
      - row-major
      # Column-major layout
      - col-major
      # Global-order layout
      - global-order
      # Unordered layout
      - unordered

  Querytype:
    description: Type of query
    type: string
    enum: &QUERYTYPE
      # READ
      - READ
      # Write
      - WRITE

  Querystatus:
    description: Status of query
    type: string
    enum: &QUERYSTATUS
      # FAILED
      - FAILED
      # COMPLETED
      - COMPLETED
      # INPROGRESS
      - INPROGRESS
      # INCOMPLETE
      - INCOMPLETE
      # UNINITIALIZED
      - UNINITIALIZED

  FilterType:
    description: TileDB filter types
    type: string
    enum: &FILTERTYPE
       # No-op filter
      - FILTER_NONE
      # Gzip compressor
      - FILTER_GZIP
      # Zstandard compressor
      - FILTER_ZSTD
      # LZ4 compressor
      - FILTER_LZ4
      # Run-length encoding compressor
      - FILTER_RLE
      # Bzip2 compressor
      - FILTER_BZIP2
      # Double-delta compressor
      - FILTER_DOUBLE_DELTA
      # Bit width reduction filter.
      - FILTER_BIT_WIDTH_REDUCTION
      # Bitshuffle filter.
      - FILTER_BITSHUFFLE
      # Byteshuffle filter.
      - FILTER_BYTESHUFFLE
      # Positive-delta encoding filter.
      - FILTER_POSITIVE_DELTA

  FilterOption:
    description: TileDB filter option
    type: string
    enum: &FILTEROPTION
      # Compression level. Type: `int32_t`
      - COMPRESSION_LEVEL
      # Max window length for bit width reduction. Type: `uint32_t`
      - BIT_WIDTH_MAX_WINDOW
      # Max window length for positive-delta encoding. Type: `uint32_t`.
      - POSITIVE_DELTA_MAX_WINDOW

  OrganizationRoles:
    description: role user has in organization
    type: string
    enum: &ORGANIZATIONROLES
      # Owner/creator of group
      - owner
      # Admin almost all rights but can't delete organization
      - admin
      # Read and write User
      - read_write
      # Read Only User
      - read_only

  ArrayActions:
    description: actions a user can take on an array
    type: string
    enum: &ARRAYACTIONS
      # Read
      - read
      # Write
      - write
      # Edit metadata about array
      - edit
      # View logs for array
      - read_array_logs
      # Permission to get array info
      - read_array_info
      # Permission to fetch the array schema
      - read_array_schema

  UDFActions:
    description: actions a user can take on an udf
    type: string
    enum: &UDFACTIONS
      # Fetch udf and run jobs
      - fetch_udf
      # Share udf with others
      - share_udf

  NamespaceActions:
    description: actions a user can take on an organization
    type: string
    enum: &NAMESPACEACTIONS
       # Fetch details about namespace and read arrays in namespace
      - read
      # Write to arrays inside namespace
      - write
      # Create arrays inside namespace
      - create
      # Delete/Deregister arrays in namespace
      - delete
      # Edit array metadata
      - edit
      # View logs for array
      - read_array_logs
      # View logs for job
      - read_job_logs
      # View change logs for namespace
      - read_object_logs
      # Run job
      - run_job
      # Delete an organization
      - delete_organization
      # Edit organization details
      - edit_organization
      # Edit billing details
      - edit_billing

  DomainArray:
    description: Domain object for an array of each type
    type: object
    properties:
      int8:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: int8
      uint8:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: uint8
      int16:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: int16
      uint16:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: uint16
      int32:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: int32
      uint32:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: uint32
      int64:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: int64
      uint64:
        type: array
        x-omitempty: true
        items:
          type: integer
          format: uint64
      float32:
        type: array
        x-omitempty: true
        items:
          type: number
          format: float
      float64:
        type: array
        x-omitempty: true
        items:
          type: number
          format: double

  Array:
    description: Represents an open array
    type: object
    required:
      - timestamp
      - queryType
      - uri
    properties:
      timestamp:
        description: timestamp (epoch milliseconds) array is opened at
        type: number
        format: uint64
        example: 1540471791873
      queryType:
        description: Array opened for query type
        $ref: "#/definitions/Querytype"
      uri:
        description: Array uri
        type: string

  Attribute:
    description: Attribute of array
    type: object
    required:
      - name
      - type
      - filterPipeline
      - cellValNum
    properties:
      name:
        description: Attribute name
        type: string
        example: attribute1
      type:
        $ref: "#/definitions/Datatype"
      filterPipeline:
        $ref: "#/definitions/FilterPipeline"
      cellValNum:
        description: Attribute number of values per cell
        type: integer
        example: 1
      fillValue:
        description: The default fill value
        type: array
        items:
          type: integer
          format: uint8

  Dimension:
    description: Dimension of array
    type: object
    required:
      - type
      - domain
      - nullTileExtent
    properties:
      name:
        description: Dimension name
        type: string
        example: "row"
      type:
        $ref: "#/definitions/Datatype"
      domain:
        description: extent of domain
        $ref: "#/definitions/DomainArray"
      nullTileExtent:
        description: Is tile extent null
        type: boolean
        example: true
      tileExtent:
        description: Extent of tile
        type: object
        properties:
          int8:
            type: integer
            format: int8
          uint8:
            type: integer
            format: uint8
          int16:
            type: integer
            format: int16
          uint16:
            type: integer
            format: uint16
          int32:
            type: integer
            format: int32
          uint32:
            type: integer
            format: uint32
          int64:
            type: integer
            format: int64
          uint64:
            type: integer
            format: uint64
          float32:
            type: integer
            format: float
          float64:
            type: integer
            format: double
      filterPipeline:
        x-omit-empty: true
        $ref: "#/definitions/FilterPipeline"

  Domain:
    description: Domain of array
    type: object
    required:
      - type
      - tileOrder
      - cellOrder
      - dimensions
    properties:
      type:
        $ref: "#/definitions/Datatype"
        description: Domain Type
      tileOrder:
        $ref: "#/definitions/Layout"
        description: Tile Order
      cellOrder:
        $ref: "#/definitions/Layout"
        description: Cell Order
      dimensions:
        type: array
        description: Array of dimensions
        items:
          $ref: "#/definitions/Dimension"

  Filter:
    description: Filter
    type: object
    required:
      - type
    properties:
      type:
        description: Filter type
        $ref: "#/definitions/FilterType"
      data:
        description: Filter data
        type: object
        properties:
          int8:
            type: integer
            format: int8
          uint8:
            type: integer
            format: uint8
          int16:
            type: integer
            format: int16
          uint16:
            type: integer
            format: uint16
          int32:
            type: integer
            format: int32
          uint32:
            type: integer
            format: uint32
          int64:
            type: integer
            format: int64
          uint64:
            type: integer
            format: uint64
          float32:
            type: integer
            format: float
          float64:
            type: integer
            format: double

  FilterPipeline:
    description: One or more filters to apply
    type: object
    properties:
      filters:
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/Filter"

  ArraySchema:
    description: ArraySchema during creation or retrieval
    type: object
    required:
      - version
      - arrayType
      - tileOrder
      - cellOrder
      - capacity
      - coordsFilterPipeline
      - offsetFilterPipeline
      - domain
      - attributes
    properties:
      uri:
        description: URI of schema
        type: string
        example: "s3://<bucket>/test_array"
      version:
        description: file format version
        type: array
        x-omitempty: true
        items:
          type: integer
        example: [1,3,0]
      arrayType:
        $ref: "#/definitions/ArrayType"
        description: Type of array
        example: sparse
      tileOrder:
        description: Tile order setting of array
        $ref: "#/definitions/Layout"
        example: row-major
      cellOrder:
        description: Order of cells
        $ref: "#/definitions/Layout"
        example: row-major
      capacity:
        description: Capacity of array
        type: integer
        format: uint64
        example: 100000
      coordsFilterPipeline:
        description: Filter pipeline used for coordinates (enum)
        $ref: "#/definitions/FilterPipeline"
      offsetFilterPipeline:
        description: Filter pipeline use for variable offsets (enum)
        $ref: "#/definitions/FilterPipeline"
      domain:
        description: Domain of array
        $ref: "#/definitions/Domain"
      attributes:
        description: Attributes of array
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/Attribute"
      allowsDuplicates:
        description:  True if the array allows coordinate duplicates. Applicable only to sparse arrays.
        type: boolean
    x-go-type:
      import:
        package: "github.com/TileDB-Inc/TileDB-Go"
        alias: "tiledb"
      type: "ArraySchema"

  AttributeBufferHeader:
    description: Represents an attribute buffer header information
    type: object
    required:
      - name
      - fixedLenBufferSizeInBytes
      - varLenBufferSizeInBytes

    properties:
      name:
        description: Attribute name
        type: string
        example: "attribute1"
      fixedLenBufferSizeInBytes:
        description: Number of bytes in the fixed-length attribute data buffer (offsets for var-len attributes)
        type: integer
        format: uint64
      varLenBufferSizeInBytes:
        description: Number of bytes in the var-length attribute data buffer
        type: integer
        format: uint64

  Writer:
    type: object
    properties:
      checkCoordDups:
        type: boolean
      checkCoordOOB:
        type: boolean
      dedupCoords:
        type: boolean
      subarray:
        $ref: "#/definitions/DomainArray"

  SubarrayRanges:
    description: A set of 1D ranges for a subarray
    type: object
    properties:
      type:
        $ref: "#/definitions/Datatype"
      hasDefaultRange:
        description: True if the range is the default range
        type: boolean
      buffer:
        description: The bytes of the ranges
        type: array
        items:
          type: integer
          format: uint8

  Subarray:
    description: A Subarray
    type: object
    properties:
      layout:
        $ref: "#/definitions/Layout"
      ranges:
        description: List of 1D ranges, one per dimension
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/SubarrayRanges"

  SubarrayPartitioner:
    description: The subarray partitioner
    type: object
    properties:
      subarray:
        $ref: "#/definitions/Subarray"
      budget:
        description: Result size budget (in bytes) for all attributes.
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/AttributeBufferSize"
      current:
        description: The current partition info
        type: object
        properties:
          subarray:
            $ref: "#/definitions/Subarray"
          start:
            description: PartitionInfo start
            type: integer
            format: uint64
          end:
            description: PartitionInfo end
            type: integer
            format: uint64
          splitMultiRange:
            description: PartitionInfo splitMultiRange
            type: boolean
      state:
        description: The state information for the remaining partitions to be produced
        type: object
        properties:
          start:
            description: State start
            type: integer
            format: uint64
          end:
            description: State end
            type: integer
            format: uint64
          singleRange:
            description: State singleRange
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/Subarray"
          multiRange:
            description: State multiRange
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/Subarray"
      memoryBudget:
        description: The memory budget for the fixed-sized attributes and the offsets of the var-sized attributes
        type: integer
        format: uint64
      memoryBudgetVar:
        description: The memory budget for the var-sized attributes
        type: integer
        format: uint64

  ReadState:
    description: state for reads
    type: object
    properties:
      initialized:
        description: True if the reader has been initialized.
        type: boolean

      overflowed:
        description: True if the query produced results that could not fit in some buffer.
        type: boolean

      unsplittable:
        description: True if the current subarray partition is unsplittable.
        type: boolean

      subarrayPartitioner:
        $ref: "#/definitions/SubarrayPartitioner"

  QueryReader:
    description: Read struct (can't be called reader due to class name conflict)
    type: object
    properties:
      layout:
        $ref: "#/definitions/Layout"
      subarray:
        $ref: "#/definitions/Subarray"
      readState:
        description: To handle incomplete read queries.
        $ref: '#/definitions/ReadState'

  Query:
    type: object
    required:
      - type
      - attributeBufferHeaders
      - layout
      - status
      - array
      - totalFixedLengthBufferBytes
      - totalVarLenBufferBytes
    properties:
      type:
        $ref: "#/definitions/Querytype"
      layout:
        $ref: "#/definitions/Layout"
      status:
        $ref: "#/definitions/Querystatus"
      attributeBufferHeaders:
        description: List of attribute buffer headers
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/AttributeBufferHeader"
      writer:
        description: writer contains data needed for continuation of global write order queries
        $ref: "#/definitions/Writer"
      reader:
        description: reader contains data needed for continuation of reads
        $ref: "#/definitions/QueryReader"
      array:
        description: Represents an open array
        $ref: "#/definitions/Array"
      totalFixedLengthBufferBytes:
        description: Total number of bytes in fixed size attribute buffers.
        type: integer
        format: uint64
      totalVarLenBufferBytes:
        description: Total number of bytes in variable size attribute buffers.
        type: integer
        format: uint64
    x-go-type:
      import:
        package: "github.com/TileDB-Inc/TileDB-Go"
        alias: "tiledb"
      type: "Query"

  NonEmptyDomain:
    type: object
    description: object representing a non-empty domain
    required:
      - nonEmptyDomain
      - isEmpty
    properties:
      nonEmptyDomain:
        description: Non Empty Domain of array
        $ref: "#/definitions/DomainArray"
      isEmpty:
        description: Is non-empty domain really empty?
        type: boolean
        example: False

  AttributeBufferSize:
    type: object
    description: object representing buffer size of an attribute
    required:
      - attribute
      - offsetBytes
      - dataBytes
    properties:
      attribute:
        description: name of attribute
        type: string
      offsetBytes:
        description: buffer size (in bytes) of offset buffer
        type: integer
        format: uint64
      dataBytes:
        description: buffer size (in bytes) of data buffer
        type: integer
        format: uint64

  MaxBufferSizes:
    type: object
    description: a list of max buffer sizes, one per attribute
    properties:
      maxBufferSizes:
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/AttributeBufferSize"

  ArrayMetadataEntry:
    type: object
    description: key/value pair representing an array metadata map entry
    properties:
      key:
        type: string
      type:
        type: string
      value_num:
        type: integer
        format: uint32
      value:
        type: array
        items:
          type: integer
          format: uint8
      del:
        type: boolean

  ArrayMetadata:
    type: object
    description: user's TileDB array metadata
    properties:
      ranges:
        description: List of metadata entries
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/ArrayMetadataEntry"

  TileDBConfig:
    type: object
    description: user's TileDB config
    properties:
      configs:
        type: object
        additionalProperties:
          type: string

  ArrayActivityLog:
    description: Actvity of an Array
    type: object
    properties:
      event_at:
        description: time event took place (RFC3339)
        type: string
        format: date-time
      action:
        description: Type of the event
        $ref: "#/definitions/ActivityEventType"
      username:
        description: User who performed action
        type: string
        example: "user1"
      bytes_sent:
        description: Bytes sent to client
        type: integer
        format: uint64
        example: 1073741824
      bytes_received:
        description: Bytes recieved from client
        type: integer
        format: uint64
        example: 1073741824
      array_task_id:
        description: uuid of associated array task
        type: string
        example:  "00000000-0000-0000-0000-000000000000"
      query_ranges:
        description: ranges for query
        x-omitempty: true
        type: string
        example: "{\"rows\":[{\"start\": 1, \"end\": 1},{\"start\": 3, \"end\": 4}],\"cols\":[{\"start\": 1, \"end\": 4}]}"

  ArrayTaskType:
    description: Synchronous Task Type
    type: string
    enum: &ARRAYTASKTYPE
      - SQL
      - UDF
      - QUERY
      - GENERIC_UDF

  ArrayTaskStatus:
    description: Status of array task
    type: string
    enum: &ARRAYTASKSTATUS
      # FAILED
      - FAILED
      # COMPLETED
      - COMPLETED
      # RUNNING
      - RUNNING

  ArrayTaskLog:
    description: Array task stderr/stdout logs
    type: object
    properties:
      array_task_id:
        description: ID of associated task
        type: string
      logs:
        description: logs from array task
        type: string

  ArrayTask:
    description: Synchronous Task to Run
    type: object
    properties:
      id:
        description: task id
        type: string
      name:
        description: Optional task name
        type: string
        example: "subarray-multiplier"
      description:
        description: Optional task description (Tasks purpose)
        type: string
        example: "Return attr a1 in the subarray bounded by coordinates and multiply attr1 by 2"
      array_metadata:
        description: Metadata of the array used in the context of this task
        $ref: "#/definitions/ArrayInfo"
      subarray:
        description: A subarray to run the array task on
        $ref: "#/definitions/DomainArray"
        example:
          - Dim1:
              Int64:
                0
                10
            Dim2:
              Int64:
                20
                22
            Dim3:
              Int64:
                10000
                10100
      memory:
        description: memory allocated to task in bytes
        type: integer
        format: uint64
        example: 1073741824
      cpu:
        description: millicpu allocated to task
        type: integer
        format: uint64
        example: 4000
      namespace:
        type: string
        description: namespace task is tied to
        example: "organization1"
      status:
        description: The status of an individual task
        $ref: "#/definitions/ArrayTaskStatus"
      start_time:
        description: Start time RFC3339 for job
        type: string
        format: date-time
      finish_time:
        description: Finish time RFC3339 for job
        type: string
        format: date-time
      cost:
        description: Cost accumulated for task in USD, example is $0.12
        type: number
        format: double
        example: 0.12
      query_type:
        description: If task type is query, whether its a read or write query
        $ref: "#/definitions/Querytype"
      udf_code:
        description: Optional actual code that is going to be executed
        type: string
      udf_language:
        description: Optional actual language used to express udf_code
        type: string
      sql_query:
        description: Optional actual sql query that is going to be executed
        type: string
      type:
        description: Type of task
        $ref: "#/definitions/ArrayTaskType"
      activity:
        description: Array activity logs for task
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/ArrayActivityLog"
      logs:
        description: logs from array task
        type: string
        x-omitempty: false

  PaginationMetadata:
    properties:
      page:
        description: pagination offset
        type: number
        format: uint64
        example: 1
      per_page:
        description: pagination limit
        type: number
        format: uint64
        example: 10
      total_pages:
        description: number of total pages with current limit
        type: number
        format: uint64
        example: 14
      total_items:
        description: number of total available items
        type: number
        format: uint64
        example: 138

  ArrayTaskData:
    description: Object including array tasks and metadata
    type: object
    properties:
      array_tasks:
        description: Array Tasks
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/ArrayTask"
      pagination_metadata:
        $ref: "#/definitions/PaginationMetadata"

  ArrayTaskBrowserSidebar:
    description: Object for ui array tasks browser page
    type: object
    properties:
      organizations:
        description: list of all unique organizations the user is part of that have array tasks
        type: array
        x-omitempty: false
        items:
          type: string
      result_count_for_all:
        description: A count of "all"
        x-omitempty: false
        type: integer
      result_count_by_namespace:
        description: A map that includes the result count by namespace
        x-omitempty: false
        additionalProperties:
          type: integer

  LastAccessedArray:
    type: object
    description: Information related to last access of an array
    properties:
      array_id:
        type: string
        description: unique id of array
        example: "00000000-0000-0000-0000-000000000000"
      array_name:
        type: string
        description: name of the array
        example: array1
      namespace:
        description: namespace of a user or organization
        type: string
        example: "mockuser"
      accessed_time:
        description: timestamp (epoch milliseconds) array is last accessed
        type: number
        format: uint64
        example: 1540471791873
      access_type:
        description: Type of the event
        $ref: "#/definitions/ActivityEventType"

  ArraySample:
    type: object
    description: Sample data from array
    properties:
      data:
        additionalProperties:
          type: object

  ArrayMetadataJson:
    type: object
    description: Metadata from array in Json format
    additionalProperties: true

  ArrayBrowserData:
    description: Object including array info and pagination metadata
    type: object
    properties:
      arrays:
        description: Array Info
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/ArrayInfo"
      pagination_metadata:
        $ref: "#/definitions/PaginationMetadata"

  ArrayBrowserSidebar:
    description: Object for ui array tasks browser page
    type: object
    properties:
      namespaces:
        description: list of all unique namespaces to display
        type: array
        x-omitempty: false
        items:
          type: string
      result_count_for_all:
        description: A count of "all" of category
        x-omitempty: false
        type: integer
      result_count_by_namespace:
        description: A map that includes the result count by namespace
        x-omitempty: false
        additionalProperties:
          type: integer

  Error:
    type:  object
    properties:
      code:
        type: integer
        format: int64
      message:
        type: string

  User:
    description: User
    type: object
    required:
      - username
    properties:
      id:
        type: string
        description: unique id of user
        example: "00000000-0000-0000-0000-000000000000"
      username:
        type: string
        minLength: 4
        maxLength: 20
        pattern: "^[\\w.\\-]+$"   # only allows alphanumeric characters
        description: username must be unique
        example: "username"
      password:
        type: string
        minLength: 8
        description: password
        example: "password"
      name:
        description: the user's full, real name
        type: string
        minLength: 1
        example: "Jane Doe"
      email:
        description: the user's email
        type: string
        example: "jane.doe@example.com"
      is_valid_email:
        description: user's email is validated to be correct
        type: boolean
        readOnly: true
        example: false
      stripe_connect:
        description: Denotes that the user is able to apply pricing to arrays by means of Stripe Connect
        type: boolean
        readOnly: true
        example: false
      company:
        description: the user's company
        type: string
        example: TileDB
      logo:
        description: the user's logo
        type: string
      last_activity_date:
        type: string
        format: date-time
        description: when the user last logged in (set by the server)
        readOnly: true
        example: "1970-01-01 00:00:00"
      timezone:
        type: string
        example: Europe/Athens
      organizations:
        type: array
        x-omitempty: true
        description: Array of organizations a user is part of and their roles
        readOnly: true
        items:
          $ref: "#/definitions/OrganizationUser"
      allowed_actions:
        description: list of actions user is allowed to do on this organization
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/NamespaceActions"
      enabled_features:
        description: List of extra/optional/beta features to enable for namespace
        type: array
        x-omitempty: true
        readOnly: true
        items:
          type: string
      unpaid_subscription:
        description: A notice that the user has an unpaid subscription
        type: boolean
        readOnly: true
        x-omitempty: false
      default_s3_path:
        description: default s3 path to store newly created notebooks
        type: string
      default_namespace_charged:
        description: Override the default namespace charged for actions when no namespace is specified
        type: string

  OrganizationUser:
    description: user in an organization
    type: object
    properties:
      user_id:
        type: string
        description: unique id of user
        example: "00000000-0000-0000-0000-000000000000"
      organization_id:
        type: string
        description: unique id of organization
        example: "00000000-0000-0000-0000-000000000000"
      username:
        description: username for user
        type: string
        example: "username"
      organization_name:
        description: name of organization
        type: string
        example: "MyOrganization"
      role:
        $ref: "#/definitions/OrganizationRoles"
      allowed_actions:
        description: list of actions user is allowed to do on this organization
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/NamespaceActions"

  Organization:
    description: Organization
    type: object
    required:
      - name
    properties:
      id:
        type: string
        description: unique id of organization
        example: "00000000-0000-0000-0000-000000000000"
      role:
        description: role of requested user within this organization
        $ref: "#/definitions/OrganizationRoles"
      name:
        type: string
        minLength: 4
        maxLength: 20
        pattern: "^[\\w.\\-]+$"   # only allows alphanumeric characters
        description: organization name must be unique
      created_at:
        description: Datetime organization was created in UTC
        type: string
        format: date-time
      updated_at:
        description: Datetime organization was updated in UTC
        type: string
        format: date-time
      logo:
        description: Organization logo
        type: string
      description:
        description: Organization description
        type: string
      users:
        type: array
        x-omitempty: true
        items:
          $ref: '#/definitions/OrganizationUser'
      allowed_actions:
        description: list of actions user is allowed to do on this organization
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/NamespaceActions"
      num_of_arrays:
        description: number of registered arrays for this organization
        type: number
        format: int32
        x-omitempty: false
      enabled_features:
        description: List of extra/optional/beta features to enable for namespace
        type: array
        x-omitempty: true
        readOnly: true
        items:
          type: string
      unpaid_subscription:
        description: A notice that the user has an unpaid subscription
        type: boolean
        readOnly: true
        x-omitempty: false
      default_s3_path:
        description: default s3 path to store newly created notebooks
        type: string

  ArraySharing:
    description: details for sharing a given array
    type: object
    properties:
      actions:
        description: List of permitted actions
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/ArrayActions"
        example:
          - read
          - write
      namespace:
        description: namespace being granted array access can be a user or organization
        type: string
        example: "MyOrganization"
      namespace_type:
        description: details on if the namespace is a organization or user
        type: string
        example: "organization"

  UDFSharing:
    description: details for sharing a given udf
    type: object
    properties:
      actions:
        description: List of permitted actions
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/UDFActions"
        example:
          - fetch
          - share
      namespace:
        description: namespace being granted array access can be a user or organization
        type: string
        example: "MyOrganization"
      namespace_type:
        description: details on if the namespace is a organization or user
        type: string
        example: "organization"

  FileType:
    description: File types represented as TileDB arrays
    type: string
    enum: &FILETYPE
      # Notebook
      - notebook
      - user_defined_function

  FilePropertyName:
    description: File property assigned to a specific file (array)
    type: string
    enum: &FILEPROPERTYNAME
      # Image name
      - image
      # Size
      - size

  PricingType:
    description: Pricing types
    type: string
    enum: &PRICINGTYPE
      # Egress pricing
      - egress
      # Access pricing
      - access

  PricingCurrency:
    description: Currency of pricing
    type: string
    enum: &PRICINGCURRENCY
      # US Dollars
      - USD

  PricingUnitLabel:
    description: Unit label
    type: string
    enum: &PRICINGUNITLABEL
      # Byte
      - byte
      # Second
      - second

  PricingAggregateUsage:
    description: Specifies a usage aggregation strategy for pricings of usage_type=metered
    type: string
    enum: &PRICINGAGGREGATEUSAGE
      # For summing up all usage during a period
      - sum

  PricingInterval:
    description: Interval for pricing
    type: string
    enum: &PRICINGINTERVAL
      # Month
      - month

  Pricing:
    description: Pricing created by converting an array to product
    type: object
    properties:
      id:
        description: Unique id of plan as defined by Stripe
        type: string
        example: "planID"
      array_uuid:
        description: Unique id of registered array
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      pricing_name:
        description: Name of pricing
        type: string
      pricing_type:
        description: Type of pricing
        $ref: "#/definitions/PricingType"
      product_name:
        description: Name of product
        type: string
      product_statement_descriptor:
        description: Extra information about a product which will appear on the credit card statement of the customer
        type: string
      product_unit_label:
        description: A label that represents units of this product in Stripe and receipts and invoices of the customer
        $ref: "#/definitions/PricingUnitLabel"
      currency:
        description: Currency of pricing
        $ref: "#/definitions/PricingCurrency"
      aggregate_usage:
        description: Specifies a usage aggregation strategy for pricings of usage_type=metered
        $ref: "#/definitions/PricingAggregateUsage"
      interval:
        description: The frequency with which a subscription should be billed
        $ref: "#/definitions/PricingInterval"
      divided_by:
        description: Group of n product unit labels
        type: integer
        format: int64
        example: 1048576
      charge:
        description: Price in cents (decimal) per unitlabel
        type: number
        format: double
      activated:
        description: If pricing is activated
        type: boolean
        example: false

  Subscription:
    description: Subscription of a user (customer) to another user's arrays
    type: object
    properties:
      id:
        description: Unique id of subscription as defined by Stripe
        type: string
        example: "subscriptionID"
      owner_namespace_uuid:
        description: Unique id of the array (product) owner
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      customer_namespace_uuid:
        description: Unique id of the array (product) user (customer)
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      pricing:
        description: list of pricing used by this subscription
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/Pricing"

  ArrayInfo:
    description: metadata of an array
    type: object
    properties:
      id:
        description: unique id of registered array
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      file_type:
        description: File type stored /wrapped by this array
        x-omitempty: true
        $ref: "#/definitions/FileType"
      file_properties:
        type: object
        description: map of file properties created for this array
        x-omitempty: true
        additionalProperties:
          type: string
      uri:
        description: uri of array
        type: string
        example: "s3://bucket/array"
      namespace:
        description: namespace array is in
        type: string
        example: "user1"
      size:
        description: size in bytes of array
        type: number
        format: uint64
        example: 1024
      last_accessed:
        description: Datetime array was last accessed in UTC
        type: string
        format: date-time
      description:
        description: description of array
        type: string
      name:
        description: name of array
        type: string
        example: myarray1
      allowed_actions:
        description: list of actions user is allowed to do on this array
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/ArrayActions"
      pricing:
        description: list of pricing created for this array
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/Pricing"
      subscriptions:
        description: list of subscriptions created for this array
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/Subscription"
      logo:
        description: logo (base64 encoded) for the array. Optional
        type: string
      access_credentials_name:
        description: the name of the access credentials to use. if unset, the default credentials will be used
        type: string
      type:
        description: Array type (dense, key-value, sparse)
        type: string
        example: sparse
      share_count:
        description: number of unique namespaces this array is shared with
        type: number
        format: int32
      public_share:
        description: Suggests if the array was shared to public by owner
        type: boolean
        x-omitempty: false
        example: true
      namespace_subscribed:
        description: Depends on the namespace asking, denotes the existence of subscription of namespace to this array
        type: boolean
        readOnly: true
        example: false
      tiledb_uri:
        description: uri for access through TileDB cloud
        type: string
        x-omitempty: false
      tags:
        description: optional tags for array
        x-omitempty: false
        type: array
        items:
          type: string
          description: tag must be lowercase characters or hypen [a-z-]
      license_id:
        type: string
        x-omitempty: true
        description: License identifier from SPDX License List or Custom
      license_text:
        type: string
        x-omitempty: true
        description: License text

  ArrayInfoUpdate:
    description: metadata of an array
    type: object
    properties:
      description:
        description: description of array
        type: string
      name:
        description: description of array
        type: string
        example: myarray1
      uri:
        description: uri of array
        type: string
        example: "s3://bucket/array"
      file_type:
        description: File type stored /wrapped by this array
        x-omitempty: true
        $ref: "#/definitions/FileType"
      file_properties:
        type: object
        description: map of file properties created for this array
        x-omitempty: true
        additionalProperties:
          type: string
      access_credentials_name:
        description: the name of the access credentials to use. if unset, the default credentials will be used
        type: string
      logo:
        description: logo (base64 encoded) for the array. Optional
        type: string
      tags:
        description: optional tags for array
        x-omitempty: false
        type: array
        items:
          type: string
          description: tag must be lowercase characters or hypen [a-z-]
      license_id:
        type: string
        x-omitempty: true
        description: License identifier from SPDX License List or Custom
      license_text:
        type: string
        x-omitempty: true
        description: License text

  TokenRequest:
    description: A request from a user for an api token
    type: object
    properties:
      expires:
        description: Expiration date for token, if empty token defaults to 30 minutes
        type: string
        format: date-time
        example: 2018-12-31T12:13:14Z
      name:
        description: Optional name for token, if the name already exists for the user it will be auto incremented (i.e. myToken-1)
        type: string
        example: myToken
      scope:
        description: "Optional scope to limit token, defaults to all permissions, current supported values are password_reset or *"
        type: string
        example: "*"
        default: "*"

  Token:
    description: A api token and its metadata
    type: object
    properties:
      token:
        description: A api token
        type: string
      name:
        description: Name of token to revoke
        type: string
      issued_at:
        description: datetime the token was created at
        type: string
        format: date-time
      expires_at:
        description: datetime the token when token will expire
        type: string
        format: date-time
      scope:
        description: Optional scope to limit token, defaults to all permissions, current supported values are password_reset or *
        type: string
        example: "*"
        default: "*"

  AWSAccessCredentials:
    description: Model representing aws keys or service role, service roles are currently ignored, but will be preferred option in the future
    type: object
    properties:
      secret_access_key:
        type: string
        description: aws secret access key, never returned in get requests
      access_key_id:
        type: string
        description: aws access key
      service_role_arn:
        type: string
        description: aws service role to use for access
      name:
        type: string
        description: human readable name
      default:
        type: boolean
        description: true if this is the default credential to be used within this namespace
        x-omitempty: false
      buckets:
        description: a whitelist of one or more buckets this key should access
        type: array
        x-omitempty: true
        items:
          type: string
          description: A bucket or path of a bucket that is granted access by these credentials
          example: "s3://company-bucket-1/tiledb/"
      created_at:
        description: Time when udf dependencies was created (rfc3339)
        type: string
        format: date-time
        readOnly: true
      updated_at:
        description: Time when udf dependencies was last updated (rfc3339)
        type: string
        format: date-time
        readOnly: true

  SSOProvider:
    description: Single sign on provider
    type: string
    enum: &SSOPROVIDER
      # Github
      - github
      # Google
      - google
      # Stripe
      - stripe

  PublicShareFilter:
    description: Query parameter to get array metadatas
    type: string
    enum: &PUBLICSHAREFILTER
      # Exclude
      - exclude
      # Only
      - only

  DimensionCoordinate:
    description: A single, typed coordinate for a dimension
    type: object
    properties:
      int8:
        type: integer
        format: int8
        x-omitempty: false
      uint8:
        type: integer
        format: uint8
        x-omitempty: false
      int16:
        type: integer
        format: int16
        x-omitempty: false
      uint16:
        type: integer
        format: uint16
        x-omitempty: false
      int32:
        type: integer
        format: int32
        x-omitempty: false
      uint32:
        type: integer
        format: uint32
        x-omitempty: false
      int64:
        type: integer
        format: int64
        x-omitempty: false
      uint64:
        type: integer
        format: uint64
        x-omitempty: false
      float32:
        type: number
        format: float
        x-omitempty: false
      float64:
        type: number
        format: double
        x-omitempty: false

  UDFSubarrayRange:
    description: A dimension range to query
    type: object
    properties:
      dimension_id:
        type: integer
        description: The dimension index
        x-omitempty: false
      range_start:
        $ref: "#/definitions/DimensionCoordinate"
        description: The range start index
        x-omitempty: false
      range_end:
        $ref: "#/definitions/DimensionCoordinate"
        description: The range end index
        x-omitempty: false

  UDFSubarray:
    description: Subarray bounds to query for a UDF to operate on
    type: object
    properties:
      layout:
        $ref: "#/definitions/Layout"
      ranges:
        description: List of ranges,
        type: array
        items:
          $ref: "#/definitions/UDFSubarrayRange"

  UDFRanges:
    description: Subarray bounds to query for a UDF to operate on
    type: object
    properties:
      layout:
        $ref: "#/definitions/Layout"
      ranges:
        description: List of ranges,
        type: array
        x-omitempty: true
        items:
          type: array
          x-omitempty: true
          items:
            type: number

  QueryRanges:
    description: Subarray bounds to query
    type: object
    properties:
      layout:
        $ref: "#/definitions/Layout"
      ranges:
        description: List of ranges,
        type: array
        x-omitempty: true
        items:
          type: array
          x-omitempty: true
          items:
            type: number

  QueryJson:
    description: Query returning results as json
    type: object
    properties:
      query_ranges:
        description: ranges to run against, generic format
        $ref: "#/definitions/QueryRanges"
      fields:
        description: List of fields to return data from, empty means return data for all fields
        type: array
        x-omitempty: true
        items:
          type: string
          x-omitempty: true

  GenericUDF:
    description: User-defined function
    type: object
    properties:
      udf_info_name:
        type: string
        description: name of UDFInfo to run, format is {namespace}/{udf_name}. Can not be used with exec
        example: TileDB-Inc/csv_ingestor
      language:
        $ref: "#/definitions/UDFLanguage"
        description: UDF language
      version:
        type: string
        description: Type-specific version
      image_name:
        type: string
        description: Docker image name to use for udf
        x-omitempty: true
      exec:
        type: string
        description: Type-specific executable text
      exec_raw:
        type: string
        x-omitempty: true
        description: optional raw text to store of serialized function, used for showing in UI
      argument:
        type: string
        description: Argument(s) to pass to udf function, tuple or list of args/kwargs which can be in native or json format
        x-omitempty: true
      result_format:
        $ref: "#/definitions/UDFResultType"
        description: type of results (native, i.e cloud pickle or json)
        x-omitempty: true
      task_name:
        description: name of task, optional
        type: string

  UDF:
    description: User-defined function
    type: object
    properties:
      udf_info_name:
        type: string
        description: name of UDFInfo to run, format is {namespace}/{udf_name}. Can not be used with exec
        example: TileDB-Inc/quickstart_median
      language:
        $ref: "#/definitions/UDFLanguage"
        description: UDF language
      version:
        type: string
        description: Type-specific version
      image_name:
        type: string
        description: Docker image name to use for udf
        x-omitempty: true
      ranges:
        description: ranges to run against, generic format
        $ref: "#/definitions/UDFRanges"
      subarray:
        $ref: "#/definitions/UDFSubarray"
        description: Subarray ranges to query, this is deprecate and `ranges` should be used instead.
      exec:
        type: string
        description: Type-specific executable text
      exec_raw:
        type: string
        x-omitempty: true
        description: optional raw text to store of serialized function, used for showing in UI
      buffers:
        description: List of buffers to fetch (attributes + coordinates)
        type: array
        x-omitempty: true
        items:
          type: string
      result_format:
        $ref: "#/definitions/UDFResultType"
        description: type of results (native, i.e cloud pickle or json)
        x-omitempty: true
      task_name:
        description: name of task, optional
        type: string
      argument:
        type: string
        description: Argument(s) to pass to udf function, tuple or list of args/kwargs which can be in native or json format
        x-omitempty: true

  UDFImage:
    description: Defines a set of images related to a specific name
    type: object
    properties:
      id:
        description: Unique id of set of images
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      name:
        type: string
        description: name of udf
      language:
        $ref: "#/definitions/UDFLanguage"
        description: UDF language

  UDFImageVersion:
    description: Defines an image that belongs to a set of images having a version
    type: object
    properties:
      id:
        description: Unique id of a versioned image
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      name:
        type: string
        description: name of UDFImageVersion
      udf_image_uuid:
        description: Unique id of the udf image set
        type: string
        x-omitempty: false
        example: "00000000-0000-0000-0000-000000000000"
      docker_image:
        type: string
        description: Uri of docker image related to current entry
      version:
        description: Image-specific version
        type: number
        format: uint64
        example: 2
      default:
        description: If current image is default version
        type: boolean
        example: true
      latest:
        description: If current image is latest version
        type: boolean
        example: true

  UDFInfoUpdate:
    description: User-defined function that can persist in db, used and shared multiple times
    type: object
    properties:
      name:
        type: string
        description: name of udf
      language:
        $ref: "#/definitions/UDFLanguage"
        description: UDF language
      version:
        type: string
        description: Type-specific version
      image_name:
        type: string
        description: Docker image name to use for udf
        x-omitempty: true
      type:
        $ref: "#/definitions/UDFType"
        description: UDF type
      exec:
        type: string
        description: Type-specific executable text
      exec_raw:
        type: string
        x-omitempty: true
        description: optional raw text to store of serialized function, used for showing in UI
      readme:
        type: string
        description: Markdown readme of udfs
      license_id:
        type: string
        x-omitempty: true
        description: License identifier from SPDX License List or Custom
      license_text:
        type: string
        x-omitempty: true
        description: License text
      tags:
        description: optional tags for udf
        x-omitempty: false
        type: array
        items:
          type: string
          description: tag must be lowercase characters or hypen [a-z-]

  UDFInfo:
    description: User-defined function that can persist in db, used and shared multiple times
    type: object
    properties:
      id:
        description: Unique id of udf
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      name:
        type: string
        description: name of udf
      language:
        $ref: "#/definitions/UDFLanguage"
        description: UDF language
      type:
        $ref: "#/definitions/UDFType"
        description: UDF type
      readme:
        type: string
        description: Markdown readme of udfs
      license_id:
        type: string
        x-omitempty: true
        description: License identifier from SPDX License List or Custom
      license_text:
        type: string
        x-omitempty: true
        description: License text
      tags:
        description: optional tags for udf
        x-omitempty: false
        type: array
        items:
          type: string
          description: tag must be lowercase characters or hypen [a-z-]

  UDFInfoVersion:
    description: Version of User-defined function that can persist in db
    type: object
    properties:
      id:
        description: Unique id of a versioned udf
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      udf_image_uuid:
        description: Unique id of the versioned image used by current udf version
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      name:
        type: string
        description: name of udf version
      version:
        type: string
        description: Type-specific version
      image_name:
        type: string
        description: Docker image name to use for udf
        x-omitempty: true
      exec:
        type: string
        description: Type-specific executable text
      exec_raw:
        type: string
        x-omitempty: true
        description: optional raw text to store of serialized function, used for showing in UI
      default:
        description: If current image version is default version
        type: boolean
        example: true

  UDFListingData:
    description: Object including udfs and metadata
    type: object
    properties:
      udf_info_list:
        description: List of UDFInfo
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/UDFInfo"
      pagination_metadata:
        $ref: "#/definitions/PaginationMetadata"

  SQLParameters:
    description: Parameters for running sql query
    type: object
    properties:
      name:
        description: name of task, optional
        type: string
      query:
        description: query to run
        type: string
      output_uri:
        type: string
        description: Output array uri
        example: "s3://my_bucket/my_output_array"

  NotebookStatus:
    description: Status details of a notebook server
    type: object
    properties:
      namespace:
        description: namespace of notebook
        type: string
      uptime:
        description: duration notebook has been running in seconds
        type: integer
        format: uint64
        example: 120
      cpu_usage:
        description: current cpu usage in millicpu
        type: integer
        format: uint64
        example: 4000
      memory_usage:
        description: memory usage in bytes
        type: integer
        format: uint64
        example: 1073741824
      memory_limit:
        description: memory allocated to notebook server in bytes
        type: integer
        format: uint64
        example: 1073741824
      cpu_count:
        description: millicpu allocated to notebook server
        type: integer
        format: uint64
        example: 4000

  Favorite:
    title: Favorite
    type: object
    x-examples: {}
    x-tags:
      - favorites
    properties:
      id:
        type: string
        description: |
          unique uuid of the favorite
      object_type:
        $ref: '#/definitions/FavoriteType'
      namespace:
        type: string
        description: The namespace the favorite is in. It won't be persisted in DB
      name:
        type: string
        description: Name of the object. It wont be persisted in DB

  FavoriteUpdate:
    title: FavoriteUpdate
    type: object
    properties:
      name:
        type: string
      namespace:
        type: string
      object_type:
        $ref: '#/definitions/FavoriteType'

  FavoriteType:
    description: List of values that FavoriteType can take
    type: string
    enum: &FAVORITETYPE
      # Array
      - ARRAY

  InvitationType:
    description: List of values that InvitationType can take
    type: string
    enum: &INVITATIONTYPE
      # Array share
      - ARRAY_SHARE
      # Join Organization
      - JOIN_ORGANIZATION

  InvitationStatus:
    description: List of values that InvitationStatus can take
    type: string
    enum: &INVITATIONSTATUS
      # Pending
      - PENDING
      # Accepted
      - ACCEPTED

  InvitationArrayShareEmail:
    description: Encapsulates information regarding inviting people using email to share array, same permissions for all invitees
    type: object
    required:
      - actions
      - invitee_email
    properties:
      actions:
        description: List of permitted actions
        type: array
        items:
          $ref: "#/definitions/ArrayActions"
        example:
          - read
          - write
      invitee_email:
        type: array
        x-omitempty: true
        items:
          type: string
          format: email

  InvitationOrganizationJoinEmail:
    description: Encapsulates information regarding inviting people using email to join organization, same permissions for all invitees
    type: object
    required:
      - invitee_email
      - organization_role
    properties:
      actions:
        description: List of permitted actions
        type: array
        items:
          $ref: "#/definitions/NamespaceActions"
        example:
          - read
          - write
      organization_role:
        description: Role of the invited namespace in the joined organization
        $ref: "#/definitions/OrganizationRoles"
        x-omitempty: false
      invitee_email:
        type: array
        x-omitempty: true
        items:
          type: string
          format: email

  Invitation:
    description: Invitations to share or collaborate
    type: object
    properties:
      id:
        description: Unique id of invitation added to magic link
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      invitation_type:
        description: Type of invitation
        $ref: "#/definitions/InvitationType"
        example: array_share
        x-omitempty: false
      owner_namespace_uuid:
        description: Namespace of the owner of the invitation (user or organization)
        type: string
        example: "00000000-0000-0000-0000-000000000000"
      user_namespace_uuid:
        description: Unique id of the user accepted the invitation
        type: string
        x-omitempty: false
        example: "00000000-0000-0000-0000-000000000000"
      organization_user_uuid:
        description: Unique id of the organization user accepted the invitation
        type: string
        x-omitempty: false
        example: "00000000-0000-0000-0000-000000000000"
      organization_name:
        description: Name of the organization, does not persist in database
        type: string
        example: "organization_name"
      organization_role:
        description: Role of the invited namespace in the joined organization
        $ref: "#/definitions/OrganizationRoles"
        x-omitempty: false
      array_uuid:
        description: Unique id of the array
        type: string
        x-omitempty: false
        example: "00000000-0000-0000-0000-000000000000"
      array_name:
        description: Name of the array, does not persist in database
        type: string
        example: "array_name"
      email:
        description: Email of the individual we send the invitation to
        type: string
        example: "jane@doe.com"
      actions:
        description: A comma separated list of ArrayActions or NamespaceActions
        type: string
        example: "read,write"
      status:
        description: Status of invitation
        $ref: "#/definitions/InvitationStatus"
        example: PENDING
        x-omitempty: false
      created_at:
        description: Datetime the invitation was created in UTC
        type: string
        format: date-time
        x-omitempty: false
      expires_at:
        description: Datetime the invitation is expected to expire in UTC
        type: string
        format: date-time
        x-omitempty: false
      accepted_at:
        description: Datetime the invitation was accepted in UTC
        type: string
        format: date-time
        x-omitempty: false

  InvitationData:
    description: Object including invitations and metadata
    type: object
    properties:
      invitations:
        description: List of invitations
        type: array
        x-omitempty: true
        items:
          $ref: "#/definitions/Invitation"
      pagination_metadata:
        $ref: "#/definitions/PaginationMetadata"


paths:
  /.stats:
    get:
      description: Fetch libtiledb stat
      tags:
        - stats
      operationId: getTiledbStats
      responses:
        200:
          description: stats
          schema:
            type: object
            properties:
              stats:
                description: string of stats from tiledb
                type: string
                example: "123"
          examples:
            application/json:
              stats: "123"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays:
    parameters:
      - name: public_share
        in: query
        type: string
        description: Public share values can be one of exclude, only
    get:
      description: get all array metadata user has access to
      tags:
        - array
      operationId: getAllArrayMetadata
      responses:
        200:
          description: array metadata for all arrays user has access to
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/ArrayInfo"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
    get:
      description: get metadata on all arrays in a namespace
      tags:
        - array
      operationId: getArraysInNamespace
      responses:
        200:
          description: array metadata for all arrays in a namespace
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/ArrayInfo"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
    delete:
      description: delete a array
      tags:
        - array
      operationId: deleteArray
      responses:
        204:
          description: delete array successful
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    get:
      description: get an ArraySchema using a url encoded uri
      produces:
        - application/json
        - application/capnp
      consumes:
        - application/json
        - application/capnp
      tags:
        - array
      operationId: getArray
      responses:
        200:
          description: get ArraySchema
          schema:
            $ref: "#/definitions/ArraySchema"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    post:
      description: create a array schema at a specified URI registered to a group/project
      tags:
        - array
      operationId: createArray
      parameters:
        - name: ArraySchema
          in: body
          description: ArraySchema being created
          schema:
            $ref: "#/definitions/ArraySchema"
          required: true
      responses:
        204:
          description: schema created successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/activity:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: start
        in: query
        description: "Start time of window of fetch logs, unix epoch in seconds (default: seven days ago)"
        type: integer
        format: uint64
        required: false
      - name: end
        in: query
        description: "End time of window of fetch logs, unix epoch in seconds (default: current utc timestamp)"
        type: integer
        format: uint64
        required: false
      - name: event_types
        in: query
        type: string
        description: Event values can be one or more of the following read, write, create, delete, register, deregister, comma separated
      - name: task_id
        in: query
        type: string
        description: Array task id To filter activity to
    get:
      description: get array activity logs
      tags:
        - array
      operationId: arrayActivityLog
      responses:
        200:
          description: log of array activity
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/ArrayActivityLog"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/deregister:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    delete:
      description: deregister a array
      tags:
        - array
      operationId: deregisterArray
      responses:
        204:
          description: deregistered array successful
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/metadata:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    get:
      description: get metadata on an array
      tags:
        - array
      operationId: getArrayMetadata
      responses:
        200:
          description: array metadata for an array
          schema:
            $ref: "#/definitions/ArrayInfo"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      description: update metadata on an array
      tags:
        - array
      operationId: updateArrayMetadata
      parameters:
        - name: array_metadata
          in: body
          description: array metadata to update
          schema:
            $ref: "#/definitions/ArrayInfoUpdate"
          required: true
      responses:
        204:
          description: array metadata updated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/register:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    post:
      description: register an array at a specified URI registered to the given namespace
      tags:
        - array
      operationId: registerArray
      parameters:
        - name: array_metadata
          in: body
          description: metadata associated with array
          schema:
            $ref: "#/definitions/ArrayInfoUpdate"
          required: true
      responses:
        204:
          description: schema registered successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/consolidate:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    post:
      description: consolidate an array at a specified URI
      tags:
        - array
      operationId: consolidateArray
      parameters:
        - name: tiledb_config
          in: body
          description: tiledb configuration
          schema:
            $ref: "#/definitions/TileDBConfig"
          required: true
      responses:
        204:
          description: array consolidated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/vacuum:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    post:
      description: vacuum an array at a specified URI
      tags:
        - array
      operationId: vacuumArray
      parameters:
        - name: tiledb_config
          in: body
          description: tiledb configuration
          schema:
            $ref: "#/definitions/TileDBConfig"
          required: true
      responses:
        204:
          description: array vacuumed successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/share:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    get:
      description: Get all sharing details of the array
      tags:
        - array
      operationId: getArraySharingPolicies
      responses:
        200:
          description: List of all specific sharing policies
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/ArraySharing"
        404:
          description: Array does not exist or user does not have permissions to view array sharing policies
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      description: Share an array with a user
      tags:
        - array
      operationId: shareArray
      parameters:
        - name: array_sharing
          in: body
          description: Namespace and list of permissions to share with. An empty list of permissions will remove the namespace, if permissions already exist they will be deleted then new ones added. In the event of a failure, the new polcies will be rolled back to prevent partial policies, and its likely the array will not be shared with the namespace at all
          schema:
            $ref: "#/definitions/ArraySharing"
          required: true
      responses:
        204:
          description: Array shared successfully
        404:
          description: Array does not exist or user does not have permissions to share array
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/non_empty_domain:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
    get:
      description: get the non empty domain of an array
      tags:
        - array
      operationId: getArrayNonEmptyDomain
      responses:
        200:
          description: get the non empty domain of an array
          schema:
            $ref: "#/definitions/NonEmptyDomain"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/max_buffer_sizes:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: subarray
        in: query
        description: CSV string of subarray to get max buffer sizes for
        type: string
        required: true
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
    get:
      description: get the max buffer sizes of an array for a subarray
      tags:
        - array
      operationId: getArrayMaxBufferSizes
      responses:
        200:
          description: get the max buffer sizes of an array for a subarray
          schema:
            $ref: "#/definitions/MaxBufferSizes"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/udf/submit:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
      - name: Accept-Encoding
        in: header
        description: Encoding to use
        type: string
      - name: v2
        in: query
        description: flag to indicate if v2 array udfs should be used, currently in beta testing. Setting any value will enable v2 array udfs
        type: string
        required: false

    post:
      description: send a UDF to run against a specified array/URI registered to a group/project
      tags:
        - udf
      operationId: submitUDF
      produces:
        - application/octet-stream
      consumes:
        - application/json
      parameters:
        - name: udf
          in: body
          description: udf to run
          schema:
            $ref: "#/definitions/UDF"
          required: true
      responses:
        200:
          description: udf completed and the udf-type specific result is returned
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed request
          schema:
            type: string
            format: binary
        default:
          description: error response
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just request if task was started
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/query/submit:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: type
        in: query
        description: type of query
        required: true
        type: string
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
      - name: open_at
        description: open_at for array in unix epoch
        in: query
        type: integer
        format: uint64
    post:
      description: send a query to run against a specified array/URI registered to a group/project
      tags:
        - query
      produces:
        - application/json
        - application/capnp
      consumes:
        - application/json
        - application/capnp
      operationId: submitQuery
      parameters:
        - name: query
          in: body
          description: query to run
          schema:
            $ref: "#/definitions/Query"
          required: true
      responses:
        200:
          description: query completed and results are returned in query object
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed query
          schema:
            $ref: "#/definitions/Query"
        204:
          description: query completed successfully with no return
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/query/submit_query_json:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
    post:
      description: send a query to run against a specified array/URI registered to a group/project, returns json results
      tags:
        - query
      produces:
        - application/json
      consumes:
        - application/json
      operationId: submitQueryJson
      parameters:
        - name: queryJson
          in: body
          description: query to run
          schema:
            $ref: "#/definitions/QueryJson"
          required: true
      responses:
        200:
          description: query completed and results are returned in json format
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed query
          schema:
            type: object
          examples:
            application/json:
              data: "{\"a1\":[0,1,2,3,0,1,2,3]}"

        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/query/get_file:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
    get:
      description: send a query to run against a specified array/URI registered to a group/project, returns file bytes
      tags:
        - query
      produces:
        - application/x-ipynb+json
      operationId: getFile
      responses:
        200:
          description: query completed and result bytes are returned
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed query
          schema:
            type: string
            format: binary
          examples:
            application/x-ipynb+json:
              data: "abcd"

        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/query/finalize:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: type
        in: query
        description: type of query
        required: true
        type: string
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
      - name: open_at
        description: open_at for array in unix epoch
        in: query
        type: integer
        format: uint64
    post:
      description: send a query to run against a specified array/URI registered to a group/project
      tags:
        - query
      produces:
        - application/json
        - application/capnp
      consumes:
        - application/json
        - application/capnp
      operationId: finalizeQuery
      parameters:
        - name: query
          in: body
          description: query to run
          schema:
            $ref: "#/definitions/Query"
          required: true
      responses:
        200:
          description: query completed and results are returned in query object
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed query
          schema:
            $ref: "#/definitions/Query"
        204:
          description: query completed successfully with no return
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/query/est_result_sizes:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: type
        in: query
        description: type of query
        required: true
        type: string
      - name: Content-Type
        in: header
        description: Content Type of input and return mime
        type: string
        required: true
        default: application/json
      - name: X-Payer
        in: header
        description: Name of organization or user who should be charged for this request
        type: string
      - name: open_at
        description: open_at for array in unix epoch
        in: query
        type: integer
        format: uint64
    post:
      description: send a query to run against a specified array/URI registered to a group/project
      tags:
        - query
      produces:
        - application/json
        - application/capnp
      consumes:
        - application/json
        - application/capnp
      operationId: getEstResultSizes
      parameters:
        - name: query
          in: body
          description: query to run
          schema:
            $ref: "#/definitions/Query"
          required: true
      responses:
        200:
          description: query est result size computed and results are returned in query object
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just computed query result size
          schema:
            $ref: "#/definitions/Query"
        204:
          description: query completed successfully with no return
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/{namespace}/{array}/sample:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: samples
        in: query
        description: Number of sample results to return
        default: 5
        type: number
        format: uint8
    get:
      description: get an sample set of data from the array
      tags:
        - array
      operationId: getArraySampleData
      responses:
        200:
          description: get array sample data
          schema:
              $ref: "#/definitions/ArraySample"
          examples:
            application/json:
              dim1:
                - 1
                - 2
                - 3
                - 1
                - 2
              dim2:
                - 1
                - 1
                - 1
                - 2
                - 2
              attribute1:
                - 1
                - 2
                - 3
                - 4
                - 5
              attribute2:
                - "test1"
                - "test2"
                - "test3"
                - "test4"
                - "test5"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
          examples:
            application/json:
              message: "Error try again"
              code: 1

  /arrays/{namespace}/{array}/metadata_json:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
      - name: length
        in: query
        description: (optional) limit character length of returned values
        type: integer
        required: false
    get:
      description: get metadata from the array in json format
      tags:
        - array
      operationId: getArrayMetaDataJson
      responses:
        200:
          description: get array metadata
          schema:
              $ref: "#/definitions/ArrayMetadataJson"
          examples:
            application/json:
              key1: 25
              key2:
                - 25
                - 26
                - 27
                - 28
              key3: 25.1
              key4:
                - 25.1
                - 26.2
                - 27.3
                - 28.4
              key5: "This is TileDB array metadata"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
          examples:
            application/json:
              message: "Error try again"
              code: 1

  /arrays/last_accessed:
    get:
      tags:
        - array
      operationId: getLastAccessedArrays
      responses:
        200:
          description: gets last accessed arrays
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/LastAccessedArray"
          examples:
            application/json:
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
          examples:
            application/json:
              message: "Error try again"
              code: 1

  /user:
    get:
      tags:
        - user
      description: get a user
      operationId: getUser
      responses:
        200:
          description: user details
          schema:
            $ref: "#/definitions/User"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    post:
      security: []
      tags:
        - user
      description: create a user
      operationId: createUser
      parameters:
        - name: user
          in: body
          description: user to create
          schema:
            $ref: "#/definitions/User"
          required: true
      responses:
        204:
          description: user created successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /user/password_reset:
    post:
      tags:
        - user
      description: reset user password
      operationId: resetUserPassword
      parameters:
        - name: user
          in: body
          description: password to update for user requesting update
          schema:
            description: Password to update
            type: object
            properties:
              password:
                type: string
                minLength: 8
                description: password
                example: "password"
          required: true
      responses:
        204:
          description: User password updated successfully
        404:
          description: User not found
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /user/confirm_email:
    post:
      tags:
        - user
      description: confirm user email
      operationId: confirmEmail
      responses:
        204:
          description: User email confirmed successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /users/{username}:
    parameters:
      - name: username
        in: path
        description: username or id
        required: true
        type: string
    get:
      tags:
        - user
      description: get a user
      operationId: getUserWithUsername
      responses:
        200:
          description: user details
          schema:
            $ref: "#/definitions/User"
        404:
          description: User does not exist
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    delete:
      tags:
        - user
      description: delete a user
      operationId: deleteUser
      responses:
        204:
          description: user deleted
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      tags:
        - user
      description: update a user
      operationId: updateUser
      parameters:
        - name: user
          in: body
          description: user details to update
          schema:
            $ref: "#/definitions/User"
          required: true
      responses:
        204:
          description: user updated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /credentials/{namespace}/aws:
    parameters:
      - name: namespace
        in: path
        description: namespace
        required: true
        type: string
    get:
      tags:
        - user
        - organization
      description: Check if aws keys are set
      operationId: checkAWSAccessCredentials
      responses:
        200:
          description: AWS keys are set
          schema:
            type: array
            items:
              $ref: "#/definitions/AWSAccessCredentials"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    post:
      tags:
        - user
        - organization
      description: Add aws keys
      operationId: addAWSAccessCredentials
      parameters:
        - name: awsAccessCredentials
          in: body
          description: aws access credentials to store for a namespace
          schema:
            $ref: "#/definitions/AWSAccessCredentials"
          required: true
      responses:
        204:
          description: AWS keys added successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /credentials/{namespace}/aws/{name}:
    parameters:
      - name: namespace
        in: path
        description: namespace
        required: true
        type: string
      - name: name
        in: path
        description: name
        required: true
        type: string
    get:
      tags:
        - user
        - organization
      description: Check if aws keys are set by name
      operationId: checkAWSAccessCredentialsByName
      responses:
        200:
          description: AWS keys are set
          schema:
            $ref: "#/definitions/AWSAccessCredentials"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      tags:
        - user
        - organization
      description: Update aws keys or associated buckets. This will update the key associations for each array in the namespace
      operationId: updateAWSAccessCredentials
      parameters:
        - name: awsAccessCredentials
          in: body
          description: aws credentials to update
          schema:
            $ref: "#/definitions/AWSAccessCredentials"
          required: true
      responses:
        204:
          description: AWS keys updated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    delete:
      tags:
        - user
        - organization
      description: delete a AWS Access credentials in a namespace. This will likely cause arrays to become unreachable
      operationId: deleteAWSAccessCredentials
      responses:
        204:
          description: AWS credentials deleted
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /organization:
    post:
      tags:
        - organization
      description: create a organization, the user creating will be listed as owner
      operationId: createOrganization
      parameters:
        - name: organization
          in: body
          description: organization to create
          schema:
            $ref: "#/definitions/Organization"
          required: true
      responses:
        204:
          description: organization created successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /organizations:
    get:
      tags:
        - organization
      description: get all organizations that the user is member of
      operationId: getAllOrganizations
      responses:
        200:
          description: array of organizations the user is member of
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/Organization"
        400:
          description: Error finding organizations
        500:
          description: Request user not found, or has empty context
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /organizations/{organization}:
    parameters:
      - name: organization
        in: path
        description: organization name or id
        required: true
        type: string
    get:
      tags:
        - organization
      description: get a organization
      operationId: getOrganization
      responses:
        200:
          description: organization details
          schema:
            $ref: "#/definitions/Organization"
        404:
          description: Organization does not exist
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    delete:
      tags:
        - organization
      description: delete a organization
      operationId: deleteOrganization
      responses:
        204:
          description: organization deleted
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      tags:
        - organization
      description: update a organization
      operationId: updateOrganization
      parameters:
        - name: organizationDetails
          in: body
          description: organization details to update
          schema:
            $ref: "#/definitions/Organization"
          required: true
      responses:
        204:
          description: organization updated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /organizations/{organization}/user:
    parameters:
      - name: organization
        in: path
        description: organization name
        required: true
        type: string
    post:
      tags:
        - user
        - organization
      description: add a user to an organization
      operationId: addUserToOrganization
      parameters:
        - name: user
          in: body
          description: user to add
          schema:
            $ref: "#/definitions/OrganizationUser"
          required: true
      responses:
        204:
          description: user added to organization successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /organizations/{organization}/{username}:
    parameters:
      - name: organization
        in: path
        description: organization name
        required: true
        type: string
      - name: username
        in: path
        description: username to manipulate
        required: true
        type: string
    get:
      tags:
        - user
        - organization
      description: get a user from an organization
      operationId: getOrganizationUser
      responses:
        200:
          description: user from organization
          schema:
            $ref: "#/definitions/OrganizationUser"
        404:
          description: User is not in organization
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    delete:
      tags:
        - user
        - organization
      description: delete a user from an organization
      operationId: deleteUserFromOrganization
      responses:
        204:
          description: user delete from organization successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      tags:
        - user
        - organization
      description: update a user in an organization
      operationId: updateUserInOrganization
      parameters:
        - name: user
          in: body
          description: user details to update
          schema:
            $ref: "#/definitions/OrganizationUser"
          required: true
      responses:
        204:
          description: user update in organization successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /session:
    parameters:
      - name: remember_me
        in: query
        description: flag to create a token with expiration of 30 days, default is false
        type: string
        required: false
    get:
      tags:
        - user
      description: Get session token for user
      operationId: getSession
      responses:
        200:
          description: Session token
          schema:
            $ref: "#/definitions/Token"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /tasks:
    parameters:
      - name: namespace
        in: query
        description: namespace to filter
        type: string
        required: false
      - name: created_by
        in: query
        description: username to filter
        type: string
        required: false
      - name: array
        in: query
        description: name/uri of array that is url-encoded to filter
        type: string
        required: false
      - name: start
        in: query
        description: start time for tasks to filter by
        type: integer
        format: uint64
        required: false
      - name: end
        in: query
        description: end time for tasks to filter by
        type: integer
        format: uint64
        required: false
      - name: page
        in: query
        description: pagination offset
        type: integer
        required: false
      - name: per_page
        in: query
        description: pagination limit
        type: integer
        required: false
      - name: type
        in: query
        description: task type, "QUERY", "SQL", "UDF"
        required: false
        type: string
      - name: status
        in: query
        description: Filter to only return these statuses
        type: string
        required: false
      - name: search
        in: query
        description: search string that will look at name, namespace or description fields
        required: false
        type: string
      - name: orderby
        in: query
        description: sort by which field valid values include start_time, name
        required: false
        type: string
    get:
      tags:
        - tasks
      description: Fetch a list of all array tasks a user has access to
      responses:
        200:
          description: Array of all tasks user has access too
          schema:
            $ref: "#/definitions/ArrayTaskData"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /tasks/sidebar:
    parameters:
      - name: start
        in: query
        description: Fetch tasks created after this time, unix epoch in seconds, default 7 days ago
        type: integer
        format: uint64
      - name: end
        in: query
        description: Fetch tasks created before this time, unix epoch in seconds, default now
        type: integer
        format: uint64
    get:
      tags:
        - array_tasks
      operationId: getArrayTasksSidebar
      responses:
        200:
          description: sidebar metadata for task definitions for all arrays user has access to
          schema:
            $ref: "#/definitions/ArrayTaskBrowserSidebar"

          examples:
            application/json:
              organizations:
                - organization1
                - organization2
                - organization3
              result_count_for_all: 74
              result_count_by_namespace:
                mockuser: 14
                organization1: 6
                organization2: 52
                organization3: 2
        404:
          description: array tasks not found
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
          examples:
            application/json:
              message: "Error try again"
              code: 1

  /task/{id}:
    parameters:
      - name: id
        in: path
        description: task id to fetch
        type: string
        required: true
    get:
      tags:
        - tasks
      description: Fetch an array task
      responses:
        200:
          description: Array task
          schema:
            $ref: "#/definitions/ArrayTask"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /token:
    post:
      tags:
        - user
      description: Request an authorization token, optionally taken a TokenRequest object to set parameters on the token
      operationId: requestToken
      parameters:
        - name: tokenRequest
          in: body
          description: token request object
          schema:
            $ref: "#/definitions/TokenRequest"
          required: false
      responses:
        200:
          description: token
          schema:
            $ref: "#/definitions/Token"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /tokens:
    get:
      tags:
        - user
      description: Fetch a list of user tokens
      responses:
        200:
          description: Array of all user created tokens
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/Token"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /tokens/{token}:
    parameters:
      - name: token
        in: path
        description: token name or token itself
        required: true
        type: string
    delete:
      tags:
        - user
      description: revoke an authorization token
      operationId: revokeToken
      responses:
        204:
          description: revokation successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /sql/{namespace}:
    parameters:
      - name: namespace
        in: path
        description: namespace to run task under is in (an organization name or user's username)
        type: string
        required: true
      - name: Accept-Encoding
        in: header
        description: Encoding to use
        type: string
    post:
      tags:
        - sql
        - tasks
      description: Run a sql query
      operationId: runSQL
      parameters:
        - name: sql
          in: body
          description: sql being submitted
          schema:
            $ref: "#/definitions/SQLParameters"
          required: true
      responses:
        200:
          description: JSON results in array of objects form, if the query returns results
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed query
          schema:
            type: array
            items:
                  type: object
                  additionalProperties: true
        204:
          description: SQL executed successfully
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed query
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /udfs/generic/{namespace}:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: Accept-Encoding
        in: header
        description: Encoding to use
        type: string

    post:
      description: submit a generic UDF in the given namespace
      tags:
        - udf
      operationId: submitGenericUDF
      produces:
        - application/octet-stream
      consumes:
        - application/json
      parameters:
        - name: udf
          in: body
          description: udf to run
          schema:
            $ref: "#/definitions/GenericUDF"
          required: true
      responses:
        200:
          description: udf completed and the udf-type specific result is returned
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just completed request
          schema:
            type: string
            format: binary
        default:
          description: error response
          headers:
            X-TILEDB-CLOUD-TASK-ID:
              type: string
              description: Task ID for just request if task was started
          schema:
            $ref: "#/definitions/Error"

  /udfs:
    parameters:
    - name: namespace
      in: query
      description: namespace to filter
      type: string
      required: false
    - name: created_by
      in: query
      description: username to filter
      type: string
      required: false
    - name: page
      in: query
      description: pagination offset
      type: integer
      required: false
    - name: per_page
      in: query
      description: pagination limit
      type: integer
      required: false
    - name: type
      in: query
      description: udf type, "generic", "single_array"
      required: false
      type: string
    - name: search
      in: query
      description: search string that will look at name, namespace or description fields
      required: false
      type: string
    - name: orderby
      in: query
      description: sort by which field valid values include created_at, last_used, name
      required: false
      type: string
    - name: tag
      in: query
      description: tag to search for, more than one can be included
      required: false
      type: array
      items:
        type: string
    get:
      description: get a all UDFs accessible to the user
      tags:
        - udf
      operationId: getUDFInfoList
      responses:
        200:
          description: UDFInfo list
          schema:
            $ref: "#/definitions/UDFListingData"
        404:
          description: udf not found
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /udf/{namespace}/{name}:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: name
        in: path
        description: name to register udf under
        type: string
        required: true
    get:
      description: get a specific UDF in the given namespace
      tags:
        - udf
      operationId: getUDFInfo
      responses:
        200:
          description: UDFInfo was retrieved successfully
          schema:
            $ref: "#/definitions/UDFInfo"
        404:
          description: udf not found
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    post:
      description: register a UDF in the given namespace
      tags:
        - udf
      operationId: registerUDFInfo
      parameters:
        - name: udf
          in: body
          description: udf to register
          schema:
            $ref: "#/definitions/UDFInfoUpdate"
          required: true
      responses:
        204:
          description: udf registered successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      description: updated an existing registerd UDF in the given namespace
      tags:
        - udf
      operationId: updateUDFInfo
      parameters:
        - name: udf
          in: body
          description: udf to update
          schema:
            $ref: "#/definitions/UDFInfoUpdate"
          required: true
      responses:
        204:
          description: udf updated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    delete:
      description: delete a registerd UDF, this will remove all sharing and can not be undone
      tags:
        - udf
      operationId: deleteUDFInfo
      responses:
        202:
          description: UDF delete successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /udf/{namespace}/{name}/share:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: name
        in: path
        description: name of UDFInfo
        type: string
        required: true
    get:
      description: Get all sharing details of the udf
      tags:
        - udf
      operationId: getUDFInfoSharingPolicies
      responses:
        200:
          description: List of all specific sharing policies
          schema:
            type: array
            x-omitempty: true
            items:
              $ref: "#/definitions/UDFSharing"
        404:
          description: UDF does not exist or user does not have permissions to view array sharing policies
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"
    patch:
      description: Share a UDF with a user
      tags:
        - udf
      operationId: shareUDFInfo
      parameters:
        - name: udf_sharing
          in: body
          description: Namespace and list of permissions to share with. An empty list of permissions will remove the namespace, if permissions already exist they will be deleted then new ones added. In the event of a failure, the new polcies will be rolled back to prevent partial policies, and its likely the udf will not be shared with the namespace at all
          schema:
            $ref: "#/definitions/UDFSharing"
          required: true
      responses:
        204:
          description: UDF shared successfully
        404:
          description: UDF does not exist or user does not have permissions to share udf
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /notebooks/server/{namespace}/status:
    parameters:
      - name: namespace
        in: path
        description: namespace notebook is in (an organization name or user's username)
        type: string
        required: true
    get:
      description: Get status of the notebook server
      tags:
        - notebook
      operationId: getNotebookServerStatus
      responses:
        200:
          description: status of running notebook
          schema:
              $ref: "#/definitions/NotebookStatus"
        202:
          description: Notebook server is pending
        404:
          description: Notebook is not running
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /notebooks/server/{namespace}:
    parameters:
      - name: namespace
        in: path
        description: namespace notebook is in (an organization name or user's username)
        type: string
        required: true
    delete:
      description: Shutdown a notebook server
      tags:
        - notebook
      operationId: shutdownNotebookServer
      responses:
        204:
          description: Notebook shutdown successfully
        404:
          description: Notebook is not running
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /notebooks/{namespace}/{array}/rename:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of notebook (array) that is url-encoded
        type: string
        required: true
    patch:
      description: update name on a notebok, moving related s3 object to new location
      tags:
        - notebook
      operationId: updateNotebookName
      parameters:
        - name: notebook_metadata
          in: body
          description: notebook (array) metadata to update
          schema:
            $ref: "#/definitions/ArrayInfoUpdate"
          required: true
      responses:
        204:
          description: notebook name updated successfully
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /invitations:
    parameters:
      - name: organization
        in: query
        description: name or id of organization to filter
        type: string
        required: false
      - name: array
        in: query
        description: name/uri of array that is url-encoded to filter
        type: string
        required: false
      - name: start
        in: query
        description: start time for tasks to filter by
        type: integer
        format: uint64
        required: false
      - name: end
        in: query
        description: end time for tasks to filter by
        type: integer
        format: uint64
        required: false
      - name: page
        in: query
        description: pagination offset
        type: integer
        required: false
      - name: per_page
        in: query
        description: pagination limit
        type: integer
        required: false
      - name: type
        in: query
        description: invitation type, "ARRAY_SHARE", "JOIN_ORGANIZATION"
        required: false
        type: string
      - name: status
        in: query
        description: Filter to only return "PENDING", "ACCEPTED"
        type: string
        required: false
      - name: orderby
        in: query
        description: sort by which field valid values include timestamp, array_name, organization_name
        required: false
        type: string
    get:
      tags:
        - invitation
      description: Fetch a list of invitations
      operationId: fetchInvitations
      responses:
        200:
          description: List of invitations and pagination metadata
          schema:
            $ref: "#/definitions/InvitationData"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /invitations/{invitation}:
    parameters:
      - name: invitation
        in: path
        description: the id of invitation about to be accepted
        type: string
        required: true
    post:
      tags:
        - invitation
      description: Accepts invitation
      operationId: acceptInvitation
      responses:
        204:
          description: Invitation was accepted successfully
        404:
          description: Could not find invitation identifier
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /invitations/{invitation}/{namespace}/{array}/share:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: invitation
        in: path
        description: the id of invitation about to be cancelled
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    delete:
      description: Cancels array sharing invitation
      tags:
        - invitation
      operationId: cancelShareArrayByInvite
      responses:
        204:
          description: Invitation cancelled successfully
        404:
          description: No invitation was found to cancel
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /invitations/{invitation}/{organization}/join:
    parameters:
      - name: invitation
        in: path
        description: the id of invitation about to be cancelled
        type: string
        required: true
      - name: organization
        in: path
        description: name or uuid of organization
        type: string
        required: true
    delete:
      description: Cancels join organization invitation
      tags:
        - invitation
      operationId: cancelJoinOrganization
      responses:
        204:
          description: Invitation cancelled successfully
        404:
          description: No invitation was found to cancel
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /invitations/{namespace}/{array}/share:
    parameters:
      - name: namespace
        in: path
        description: namespace array is in (an organization name or user's username)
        type: string
        required: true
      - name: array
        in: path
        description: name/uri of array that is url-encoded
        type: string
        required: true
    post:
      tags:
        - invitation
      description: Sends email to multiple recipients with sharing information regarding an array
      operationId: shareArrayByInvite
      parameters:
        - name: email_invite
          in: body
          description: list of email recipients
          schema:
            $ref: "#/definitions/InvitationArrayShareEmail"
          required: true
      responses:
        204:
          description: Email sent successfully to user for email confirmation link
        404:
          description: Could not reach one or more recipients
          schema:
            $ref: "#/definitions/InvitationArrayShareEmail"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /invitations/{organization}/join:
    parameters:
      - name: organization
        in: path
        description: name or uuid of organization
        type: string
        required: true
    post:
      tags:
        - invitation
      description: Sends email to multiple recipients with joining information regarding an organization
      operationId: joinOrganization
      parameters:
        - name: email_invite
          in: body
          description: list of email recipients
          schema:
            $ref: "#/definitions/InvitationOrganizationJoinEmail"
          required: true
      responses:
        204:
          description: Email sent successfully to user for email confirmation link
        404:
          description: Could not reach one or more recipients
          schema:
            $ref: "#/definitions/InvitationOrganizationJoinEmail"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/browser/shared:
    parameters:
      - name: page
        in: query
        description: pagination offset
        type: integer
        required: false
      - name: per_page
        in: query
        description: pagination limit
        type: integer
        required: false
      - name: search
        in: query
        description: search string that will look at name, namespace or description fields
        required: false
        type: string
      - name: namespace
        in: query
        description: namespace
        required: false
        type: string
      - name: orderby
        in: query
        description: sort by which field valid values include last_accessed, size, name
        required: false
        type: string
      - name: permissions
        in: query
        description: permissions valid values include read, read_write, write, admin
        required: false
        type: string
      - name: tag
        in: query
        description: tag to search for, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: exclude_tag
        in: query
        description: tags to exclude matching array in results, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: file_type
        in: query
        description: file_type to search for, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: exclude_file_type
        in: query
        description: file_type to exclude matching array in results, more than one can be included
        required: false
        type: array
        items:
          type: string
    get:
      tags:
        - array
      description: Fetch a list of all arrays that have been shared with the user
      responses:
        200:
          description: Array of array info that has been shared with the user
          schema:
            $ref: "#/definitions/ArrayBrowserData"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/browser/shared/sidebar:
    get:
      tags:
        - array
      description: Fetch a list of all arrays that have been shared with the user
      responses:
        200:
          description: Array of array info that has been shared with the user
          schema:
            $ref: "#/definitions/ArrayBrowserSidebar"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/browser/public:
    parameters:
      - name: page
        in: query
        description: pagination offset
        type: integer
        required: false
      - name: per_page
        in: query
        description: pagination limit
        type: integer
        required: false
      - name: search
        in: query
        description: search string that will look at name, namespace or description fields
        required: false
        type: string
      - name: namespace
        in: query
        description: namespace
        required: false
        type: string
      - name: orderby
        in: query
        description: sort by which field valid values include last_accessed, size, name
        required: false
        type: string
      - name: permissions
        in: query
        description: permissions valid values include read, read_write, write, admin
        required: false
        type: string
      - name: tag
        in: query
        description: tag to search for, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: exclude_tag
        in: query
        description: tags to exclude matching array in results, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: file_type
        in: query
        description: file_type to search for, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: exclude_file_type
        in: query
        description: file_type to exclude matching array in results, more than one can be included
        required: false
        type: array
        items:
          type: string
    get:
      tags:
        - array
      description: Fetch a list of all arrays that have been shared publically
      responses:
        200:
          description: Array of array info that has been shared publically
          schema:
            $ref: "#/definitions/ArrayBrowserData"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/browser/public/sidebar:
    get:
      tags:
        - array
      description: Fetch a sidebar of all arrays that have been shared publically
      responses:
        200:
          description: Array of array info that has been shared publically
          schema:
            $ref: "#/definitions/ArrayBrowserSidebar"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/browser/owned:
    parameters:
      - name: page
        in: query
        description: pagination offset
        type: integer
        required: false
      - name: per_page
        in: query
        description: pagination limit
        type: integer
        required: false
      - name: search
        in: query
        description: search string that will look at name, namespace or description fields
        required: false
        type: string
      - name: namespace
        in: query
        description: namespace
        required: false
        type: string
      - name: orderby
        in: query
        description: sort by which field valid values include last_accessed, size, name
        required: false
        type: string
      - name: permissions
        in: query
        description: permissions valid values include read, read_write, write, admin
        required: false
        type: string
      - name: tag
        in: query
        description: tag to search for, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: exclude_tag
        in: query
        description: tags to exclude matching array in results, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: file_type
        in: query
        description: file_type to search for, more than one can be included
        required: false
        type: array
        items:
          type: string
      - name: exclude_file_type
        in: query
        description: file_type to exclude matching array in results, more than one can be included
        required: false
        type: array
        items:
          type: string
    get:
      tags:
        - array
      description: Fetch a list of all arrays that are owned directly by user or user's organizations
      responses:
        200:
          description: Array of array info that are owned directly by user or user's organizations
          schema:
            $ref: "#/definitions/ArrayBrowserData"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /arrays/browser/owned/sidebar:
    get:
      tags:
        - array
      description: Fetch a sidebar for arrays that are owned directly by user or user's organizations
      responses:
        200:
          description: Array of array info that are owned directly by user or user's organizations
          schema:
            $ref: "#/definitions/ArrayBrowserSidebar"
        default:
          description: error response
          schema:
            $ref: "#/definitions/Error"

  /favorites:
    get:
      tags:
        - favorites
      description: Fetch all favorites of connected user
      responses:
        '200':
          description: OK
          schema:
            type: array
            items:
              $ref: '#/definitions/Favorite'
      operationId: getFavorites
      parameters:
        - type: string
          in: query
          name: type
          description: The type of the desired favorites e.g. arrays
    post:
      tags:
        - favorites
      description: Add a new favorite
      operationId: postFavorite
      responses:
        '200':
          description: OK
      parameters:
        - in: body
          name: body
          schema:
            $ref: '#/definitions/FavoriteUpdate'
  /favorites/{id}:
    parameters:
      - type: string
        name: id
        in: path
        required: true
        description: The uuid of the favorite
    get:
      tags:
        - favorites
      description: Fetch specific favorite of a user
      responses:
        '200':
          description: OK
          schema:
            $ref: '#/definitions/Favorite'
      operationId: getFavorite
    delete:
      tags:
        - favorites
      description: Delete specific favorite
      operationId: deleteFavoriteId
      responses:
        '200':
          description: OK
